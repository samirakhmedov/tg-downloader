amends "templates/TgDownloaderConfig.pkl"

botConfiguration {
    tgBotApiKey = "PASTE KEY HERE"

    updateTimeout = 0

    updateLimit = 2

    botName = "example"
}

authConfiguration {
    admininstrators {
        new {
            userName = "ADMIN"
        }
    }
}

commandConfiguration {
    commands {
        ["activateGroup"] {
            command = "/a"
            description = "Activate this group for downloading"
            accessLevel = "user"
        }
        ["deactivateGroup"] {
            command = "/d"
            description = "Deactivate this group"
            accessLevel = "user"
        }
        ["getBotCommands"] {
            command = "/i"
            description = "Get available bot commands"
            accessLevel = "user"
        }
        ["loadResource"] {
            command = "/l"
            description = "Load resource for downloading"
            accessLevel = "user"
        }
        ["start"] {
            command = "/start"
            description = "Sthart the bot"
            accessLevel = "user"
        }
        ["getServerLoad"] {
            command = "/l"
            description = "Get server load information"
            accessLevel = "admin"
        }
        ["getAllGroups"] {
            command = "/a"
            description = "Get all groups"
            accessLevel = "admin"
        }
        ["deleteGroup"] {
            command = "/d"
            description = "Delete a group"
            accessLevel = "admin"
        }
    }

    supportedLinks {
        new {
            name = "Instagram Reels"
            pattern = "^https://(?:www\\.)?instagram\\.com/reel/[A-Za-z0-9_-]+/?(?:\\?.*)?$"
            example = "EXAMPLE"
        }
        new {
            name = "TikTok"
            pattern = "^https://(?:www\\.)?vt\\.tiktok\\.com/[A-Za-z0-9]+/?(?:\\?.*)?$"
            example = "EXAMPLE"
        }
        new {
            name = "YouTube Shorts"
            pattern = "^https://(?:www\\.)?youtube\\.com/shorts/[A-Za-z0-9_-]+/?(?:\\?.*)?$"
            example = "EXAMPLE"
        }
        new {
            name = "Twitter/X Shorts"
            pattern = "^https://(?:www\\.)?vxtwitter\\.com/[A-Za-z0-9_]+/status/[0-9]+(?:\\?.*)?$"
            example = "EXAMPLE"
        }
        // Any new formats...
    }
}

commonDownloaderConfiguration {
    ytdlpExecutablePath = "YT-DLP-PATH-FOR-DOWNLOAD"

    // Browser cookies for authentication (helps with TikTok, Instagram, etc.)
    cookiesFromBrowser = "firefox"

    // Force IPv4 to avoid IPv6 connectivity issues
    forceIPv4 = true

    // Sleep intervals to avoid rate limiting
    sleepInterval = 1.0
    maxSleepInterval = 3.0

    // TikTok-specific API hostname workaround for Linux issues
    tiktokApiHostname = "api.tiktokv.com"

    // Additional extractor arguments
    extractorArgs {
        "youtube:player_client=android,web"
        
        // ...
    }

    // Custom HTTP headers
    customHeaders {
        "Accept-Language:en-US,en;q=0.9"
        "Accept-Encoding:gzip, deflate, br"
        "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
        // ...
    }
}

videoDownloaderConfiguration {
    outputFormat = "mp4"
    videoQuality = "best[height<=720]/best[height<=1080]/best"
    maxFileSizeMB = 10
}

workerConfiguration {
    workerCount = 10
    taskPollingInterval = 1
    maxRetries = 2
}

debug = false